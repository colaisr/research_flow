# Тестовый 3-шаговый процесс

## Назначение
Простой процесс для тестирования:
1. Логики использования предыдущих шагов
2. Переменных, ссылающихся на предыдущие шаги
3. Контекста вокруг переменных

## Процесс: "Анализ городов"

### Шаг 1: "generate_cities"
**Название шага:** `generate_cities`

**Системный промпт:**
```
Ты помощник, который создает структурированные списки.
```

**Пользовательский промпт:**
```
Создай список из 5 случайных городов мира. Для каждого города укажи:
1. Название города
2. Страну
3. Население (примерно)

Форматируй ответ как нумерованный список.
```

**Модель:** gpt-4o-mini
**Температура:** 0.7
**Макс. токенов:** 500

---

### Шаг 2: "analyze_cities"
**Название шага:** `analyze_cities`

**Системный промпт:**
```
Ты эксперт по географии и туризму.
```

**Пользовательский промпт:**
```
Ниже представлен список городов из предыдущего шага:

{generate_cities_output}

Для каждого города из этого списка напиши:
1. Одна интересная особенность или достопримечательность
2. Климатическая характеристика (кратко)
3. Рекомендация: стоит ли посетить этот город (да/нет и почему)

Форматируй ответ так же, как исходный список (нумерованный список).
```

**Модель:** gpt-4o-mini
**Температура:** 0.7
**Макс. токенов:** 1000

**Включить контекст из предыдущих шагов:** ✅ (должен автоматически включить `generate_cities_output`)

---

### Шаг 3: "final_report"
**Название шага:** `final_report`

**Системный промпт:**
```
Ты профессиональный аналитик, создающий структурированные отчеты.
```

**Пользовательский промпт:**
```
На основе анализа городов создай финальный отчет.

Исходный список городов:
{generate_cities_output}

Анализ городов:
{analyze_cities_output}

Создай краткий отчет (2-3 абзаца), который включает:
1. Общее резюме по всем городам
2. Самый интересный город для посещения (с обоснованием)
3. Рекомендации для путешественников

Форматируй отчет профессионально, используй заголовки.
```

**Модель:** gpt-4o-mini
**Температура:** 0.7
**Макс. токенов:** 1500

**Включить контекст из предыдущих шагов:** ✅ (должен автоматически включить оба предыдущих шага)

---

## Что тестируем:

### ✅ Тест 1: Переменные работают
- Шаг 2 использует `{generate_cities_output}` - должен получить вывод шага 1
- Шаг 3 использует `{generate_cities_output}` и `{analyze_cities_output}` - должен получить выводы обоих предыдущих шагов

### ✅ Тест 2: Контекст вокруг переменных
- В шаге 2: переменная `{generate_cities_output}` окружена текстом "Ниже представлен список городов из предыдущего шага:" - LLM должен понимать контекст
- В шаге 3: обе переменные окружены пояснительным текстом - LLM должен понимать, что это за данные

### ✅ Тест 3: Порядок шагов
- Шаг 2 не может ссылаться на `{final_report_output}` (шаг идет после)
- Шаг 3 может ссылаться на оба предыдущих шага

### ✅ Тест 4: Результат
- Последний шаг (`final_report`) автоматически становится результатом
- Результат должен содержать финальный отчет

---

## Ожидаемый результат:

После выполнения всех 3 шагов, в разделе "Research Result" должен отображаться финальный отчет из шага 3, который включает:
- Резюме по всем городам
- Самый интересный город для посещения
- Рекомендации для путешественников

---

## Альтернативный простой вариант (для быстрого теста):

Если нужен еще более простой тест:

### Шаг 1: "numbers"
```
Создай список из 5 случайных чисел от 1 до 100. Выведи их через запятую.
```

### Шаг 2: "sum"
```
Числа из предыдущего шага: {numbers_output}

Вычисли сумму этих чисел и напиши результат.
```

### Шаг 3: "analysis"
```
Сумма чисел: {sum_output}
Исходные числа: {numbers_output}

Проанализируй: является ли сумма четным или нечетным числом? Больше ли она 100?
```

Этот вариант еще проще для проверки базовой функциональности.

