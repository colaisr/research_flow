"""update_crypto_and_equity_to_russian

Revision ID: da8ff47549c8
Revises: f830a5a16a5f
Create Date: 2025-11-14 00:20:00.000000

"""
from alembic import op
import sqlalchemy as sa
from sqlalchemy import text
import json


# revision identifiers, used by Alembic.
revision = 'da8ff47549c8'
down_revision = 'f830a5a16a5f'
branch_labels = None
depends_on = None


def upgrade() -> None:
    """Update crypto and equity analysis types to use Russian prompts."""
    conn = op.get_bind()
    
    # Updated Crypto analysis type config (Russian)
    crypto_config = {
        "steps": [
            {
                "step_name": "wyckoff",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ðº ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ñƒ Wyckoff, Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ Ðº ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ñ€Ñ‹Ð½ÐºÐ° 24/7 Ð´Ð»Ñ Ð²Ñ‹ÑÐ²Ð»ÐµÐ½Ð¸Ñ Ñ„Ð°Ð· Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ, Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ, Ñ€Ð¾ÑÑ‚Ð° Ð¸ Ð¿Ð°Ð´ÐµÐ½Ð¸Ñ. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑˆÑŒ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¸ Ð±Ð¸Ñ€Ð¶, Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ ÐºÐ¸Ñ‚Ð¾Ð² Ð¸ Ð²Ñ‹ÑÐ¾ÐºÑƒÑŽ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð².",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° Ñ‚Ð°Ð¹Ð¼Ñ„Ñ€ÐµÐ¹Ð¼Ðµ {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Wyckoff.\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 20 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð¢ÐµÐºÑƒÑ‰ÑƒÑŽ Ñ„Ð°Ð·Ñƒ Wyckoff (ÐÐ°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ðµ/Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ/Ð Ð¾ÑÑ‚/ÐŸÐ°Ð´ÐµÐ½Ð¸Ðµ)\n2. ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ñ€Ñ‹Ð½ÐºÐ° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸ 24/7 Ð¸ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸\n3. Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹Ð¹ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ (Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ Ñ€Ð°Ð·Ð²Ð¾Ñ€Ð¾Ñ‚)\n4. ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ\n5. ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ/Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÐºÐ¸Ñ‚Ð¾Ð²\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "smc",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Smart Money Concepts (SMC), Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ Ðº ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ñ€Ñ‹Ð½ÐºÐ° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸, Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² Ð±Ð¸Ñ€Ð¶ Ð¸ Ð·Ð¾Ð½ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸, Ð³Ð´Ðµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹ ÑÑ‚Ð¾Ð¿Ñ‹ Ñ€Ð¾Ð·Ð½Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð².",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Smart Money Concepts.\n\nÐ¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. BOS (Break of Structure) Ð¸ CHoCH Ñ‚Ð¾Ñ‡ÐºÐ¸\n2. Order Blocks (OB) â€” Ð·Ð¾Ð½Ñ‹ ÑÐ¿Ñ€Ð¾ÑÐ°/Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ\n3. Fair Value Gaps (FVG) â€” Ð·Ð¾Ð½Ñ‹ Ð´Ð¸ÑÐ±Ð°Ð»Ð°Ð½ÑÐ°\n4. Ð—Ð¾Ð½Ñ‹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ â€” Ð³Ð´Ðµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹ ÑÑ‚Ð¾Ð¿Ñ‹ Ñ€Ð¾Ð·Ð½Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð² (Ð½Ð°Ð´ Ñ…Ð°ÑÐ¼Ð¸/Ð¿Ð¾Ð´ Ð»Ð¾ÑÐ¼Ð¸)\n5. ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð¾Ð²\n6. Ð—Ð¾Ð½Ñ‹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… Ð±Ð¸Ñ€Ð¶\n\nÐ£ÐºÐ°Ð¶Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ†ÐµÐ½Ð¾Ð²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸. ÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "vsa",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Volume Spread Analysis (VSA) Ð´Ð»Ñ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¾Ð±ÑŠÑ‘Ð¼Ð° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² Ð±Ð¸Ñ€Ð¶, Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ¸Ñ‚Ð¾Ð² Ð¸ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð˜Ñ‰ÐµÑˆÑŒ ÑÐ¸Ð³Ð½Ð°Ð»Ñ‹: no demand, no supply, stopping volume, climactic action, effort vs result.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Volume Spread Analysis.\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ OHLCV (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 30 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ ÐºÑ€ÑƒÐ¿Ð½Ñ‹Ñ… ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² (Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ ÐºÐ¸Ñ‚Ð¾Ð², Ð¿Ð¾Ñ‚Ð¾ÐºÐ¸ Ð±Ð¸Ñ€Ð¶)\n2. Ð¡Ð¸Ð³Ð½Ð°Ð»Ñ‹ no demand / no supply\n3. Stopping volume (Ð¿Ð¾Ð³Ð»Ð¾Ñ‰ÐµÐ½Ð¸Ðµ)\n4. Climactic action (Ð¸ÑÑ‚Ð¾Ñ‰Ð°ÑŽÑ‰Ð¸Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ)\n5. Effort vs result (Ð¾Ð±ÑŠÑ‘Ð¼ vs Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹)\n6. Ð—Ð¾Ð½Ñ‹, Ð³Ð´Ðµ ÑƒÑÐ¸Ð»Ð¸Ðµ Ð±ÐµÐ· Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð° Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ Ð¾ Ñ€Ð°Ð·Ð²Ð¾Ñ€Ð¾Ñ‚Ðµ\n7. ÐÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ðµ Ð²ÑÐ¿Ð»ÐµÑÐºÐ¸ Ð¾Ð±ÑŠÑ‘Ð¼Ð°, ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ðµ Ð½Ð° Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ ÐºÐ¸Ñ‚Ð¾Ð²\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "delta",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Delta-Ð°Ð½Ð°Ð»Ð¸Ð·Ñƒ Ð´Ð»Ñ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº vs Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² Ð±Ð¸Ñ€Ð¶, Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ¸Ñ‚Ð¾Ð² Ð¸ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ñ‡Ð°ÑÑ‚Ð¾Ñ‚Ð½Ð¾Ð¹ Ð¿Ñ€Ð¸Ñ€Ð¾Ð´Ñ‹ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð².",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ð¼Ð¸ Delta-Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.\n\nÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ: ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº/Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ð¸Ð· Ð¾Ð±ÑŠÑ‘Ð¼Ð° Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð¹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² Ð±Ð¸Ñ€Ð¶.\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ Ð¸ Ð¾Ð±ÑŠÑ‘Ð¼Ñƒ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 30 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð”Ð¾Ð¼Ð¸Ð½Ð°Ñ†Ð¸Ñ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº vs Ð¿Ñ€Ð¾Ð´Ð°Ð¶\n2. ÐÐ½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð´ÐµÐ»ÑŒÑ‚Ñ‹ (Ð½ÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ð¾Ðµ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº/Ð¿Ñ€Ð¾Ð´Ð°Ð¶)\n3. Ð—Ð¾Ð½Ñ‹ Ð°Ð±ÑÐ¾Ñ€Ð±Ñ†Ð¸Ð¸ (Ð¾Ð±ÑŠÑ‘Ð¼ Ð±ÐµÐ· Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹)\n4. Ð”Ð¸Ð²ÐµÑ€Ð³ÐµÐ½Ñ†Ð¸Ð¸ (Ñ†ÐµÐ½Ð° vs Ð¾Ð±ÑŠÑ‘Ð¼/ÑÐ¸Ð»Ð°)\n5. Ð“Ð´Ðµ ÐºÑ€ÑƒÐ¿Ð½Ñ‹Ðµ Ð¸Ð³Ñ€Ð¾ÐºÐ¸ (ÐºÐ¸Ñ‚Ñ‹) ÑƒÐ´ÐµÑ€Ð¶Ð¸Ð²Ð°ÑŽÑ‚ Ð¸Ð»Ð¸ Ð¿Ð¾Ð³Ð»Ð¾Ñ‰Ð°ÑŽÑ‚\n6. ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¿Ð¾Ñ‚Ð¾ÐºÐ¾Ð² Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð² ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… Ð±Ð¸Ñ€Ð¶\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "ict",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸Ð¸ ICT (Inner Circle Trader), Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¹ Ðº ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð¼Ð°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒÑŽ, PD Arrays, Fair Value Gaps Ð¸ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð° Ð¿Ð¾ÑÐ»Ðµ ÑÐ±Ð¾Ñ€Ð¾Ð² Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑˆÑŒ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»ÑŽ 24/7 Ð¸ Ð²Ñ‹ÑÐ¾ÐºÑƒÑŽ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚ÑŒ.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸ÐµÐ¹ ICT.\n\nÐ”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:\n- Ð¤Ð°Ð·Ð° Wyckoff: {wyckoff_output}\n- Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° SMC: {smc_output}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. ÐœÐ°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒÑŽ (ÑÐ±Ð¾Ñ€Ñ‹ Ð½Ð°Ð´ Ñ…Ð°ÑÐ¼Ð¸/Ð¿Ð¾Ð´ Ð»Ð¾ÑÐ¼Ð¸, Ð³Ð´Ðµ ÑÑ‚Ð¾Ð¿Ñ‹ Ñ€Ð¾Ð·Ð½Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð²)\n2. PD Arrays (Ð·Ð¾Ð½Ñ‹ Premium/Discount)\n3. Fair Value Gaps (FVG) Ð´Ð»Ñ Ð·Ð¾Ð½ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°\n4. ÐžÐ¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð° Ð¿Ð¾ÑÐ»Ðµ ÑÐ±Ð¾Ñ€Ð° Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸\n5. Ð›Ð¾Ð¶Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð¾Ð¸ Ð¸ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¸ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°\n6. Ð—Ð¾Ð½Ñ‹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ñ… Ð±Ð¸Ñ€Ð¶\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data", "previous_steps"]
            },
            {
                "step_name": "price_action",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Price Action Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ñƒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð² Ð´Ð»Ñ ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚Ð½Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÐ²ÐµÑ‡Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹, Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹ Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð²Ñ‹ÑÐ¾ÐºÐ¾Ð¹ Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸ Ð¸ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸ 24/7. Ð¤Ð¾ÐºÑƒÑÐ¸Ñ€ÑƒÐµÑˆÑŒÑÑ Ð½Ð° Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°Ñ…: Ñ„Ð»Ð°Ð³Ð¸, Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸, Ð³Ð¾Ð»Ð¾Ð²Ð°-Ð¿Ð»ÐµÑ‡Ð¸, ÐºÑ€Ð¸Ð¿Ñ‚Ð¾-ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Price Action Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð².\n\nÐ”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‰Ð¸ÐµÑÑ Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ (Ñ„Ð»Ð°Ð³Ð¸, Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸, Ð³Ð¾Ð»Ð¾Ð²Ð°-Ð¿Ð»ÐµÑ‡Ð¸, Ð´Ð²Ð¾Ð¹Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑˆÐ¸Ð½Ñ‹/Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ñ‚.Ð´.)\n2. Ð¡Ð²ÐµÑ‡Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ (Ð´Ð¾Ð´Ð¶Ð¸, Ð¿Ð¾Ð³Ð»Ð¾Ñ‰ÐµÐ½Ð¸Ðµ, Ð¿Ð¸Ð½-Ð±Ð°Ñ€Ñ‹, Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹, Ð¿Ð°Ð´Ð°ÑŽÑ‰Ð¸Ðµ Ð·Ð²Ñ‘Ð·Ð´Ñ‹)\n3. Ð£Ñ€Ð¾Ð²Ð½Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ Ð¸ ÑÐ¾Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸Ð· Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹\n4. Ð¡Ð¸Ð³Ð½Ð°Ð»Ñ‹ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð° Ð¸ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð°\n5. Ð£Ñ€Ð¾Ð²Ð½Ð¸ ÑÑ‚Ð¾Ð¿-Ð»Ð¾ÑÑÐ° Ð¸ Ñ†ÐµÐ»Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°\n6. ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹, Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð½Ñ‹Ðµ Ð½Ð° Ð²Ð¾Ð»Ð°Ñ‚Ð¸Ð»ÑŒÐ½Ð¾ÑÑ‚Ð¸\n\nÐ£ÐºÐ°Ð¶Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ†ÐµÐ½Ð¾Ð²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð¾Ð², ÑÑ‚Ð¾Ð¿Ð¾Ð² Ð¸ Ñ†ÐµÐ»ÐµÐ¹. Ð•ÑÐ»Ð¸ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ„Ð¸Ð³ÑƒÑ€Ð° â€” Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐºÐ°Ð¶Ð¸ (\"Ñ€Ð¸ÑÑƒÐµÑ‚ Ñ„Ð»Ð°Ð³\", \"Ð¿Ð¾Ñ…Ð¾Ð¶Ðµ Ð½Ð° Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‰ÑƒÑŽÑÑ Ð“Ð˜ÐŸ\").",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "merge",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ðº ÐºÑ€Ð¸Ð¿Ñ‚Ð¾Ð²Ð°Ð»ÑŽÑ‚. Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑˆÑŒ Ð½Ð° ÑÐ¸Ð½Ñ‚ÐµÐ·Ðµ Wyckoff + SMC + VSA/Delta + ICT + Price Action. Ð¢Ð²Ð¾Ñ Ñ†ÐµÐ»ÑŒ â€” Ð´Ð°Ñ‚ÑŒ Ð³Ð¾Ñ‚Ð¾Ð²ÑƒÑŽ Ð¸Ð´ÐµÑŽ, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ð¾Ð¹Ñ‚Ð¸ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ. ÐŸÐ¸ÑˆÐµÑˆÑŒ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, ÐºÐ°Ðº Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ñƒ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°: Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð², Ð±ÐµÐ· \"ÑƒÐ¼Ð½Ñ‹Ñ…\" Ñ„Ñ€Ð°Ð·, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑƒÑ‚ÑŒ, Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð¸ÐºÐ°.",
                "user_prompt_template": "ÐžÐ±ÑŠÐµÐ´Ð¸Ð½Ð¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° {instrument} Ð½Ð° Ñ‚Ð°Ð¹Ð¼Ñ„Ñ€ÐµÐ¹Ð¼Ðµ {timeframe} Ð² ÐµÐ´Ð¸Ð½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ Ð´Ð»Ñ Telegram.\n\nÐ ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ð°Ð¼:\n\n1ï¸âƒ£ WYCKOFF:\n{wyckoff_output}\n\n2ï¸âƒ£ SMC (Smart Money Concepts):\n{smc_output}\n\n3ï¸âƒ£ VSA (Volume Spread Analysis):\n{vsa_output}\n\n4ï¸âƒ£ DELTA:\n{delta_output}\n\n5ï¸âƒ£ ICT:\n{ict_output}\n\n6ï¸âƒ£ PRICE ACTION / PATTERNS:\n{price_action_output}\n\n---\n\nÐ¢ÐµÐ¿ÐµÑ€ÑŒ ÑÐ¾Ð·Ð´Ð°Ð¹ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ Telegram, ÑÐ»ÐµÐ´ÑƒÑ Ð¢ÐžÐ§ÐÐž ÑÑ‚Ð¾Ð¼Ñƒ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñƒ:\n\nðŸ’Ž ÐšÐ Ð˜ÐŸÐ¢Ðž: {instrument}\nðŸ“ˆ Ð¡Ð¦Ð•ÐÐÐ Ð˜Ð™: [Ð‘Ñ‹Ñ‡Ð¸Ð¹ / ÐœÐµÐ´Ð²ÐµÐ¶Ð¸Ð¹ / Ð‘Ð¾ÐºÐ¾Ð²Ð¾Ð¹]\nðŸŽ¯ Ð’Ð•Ð ÐžÐ¯Ð¢ÐÐžÐ¡Ð¢Ð¬: [Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾ XX %] â€” [ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ð°]\nâš¡ï¸ Ð£Ð ÐžÐ’Ð•ÐÐ¬: [Ð·Ð¾Ð½Ð° / ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ] â€” [Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ]\nðŸš€ Ð¡Ð”Ð•Ð›ÐšÐ #1 (Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ): [Ð²Ñ…Ð¾Ð´ | ÑÑ‚Ð¾Ð¿ | Ñ‚ÐµÐ¹Ðº]\nðŸ§­ Ð¡Ð”Ð•Ð›ÐšÐ #2 (Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ 4-12 Ñ‡Ð°ÑÐ¾Ð²): [Ð²Ñ…Ð¾Ð´ | ÑÑ‚Ð¾Ð¿ | Ñ‚ÐµÐ¹Ðº]\nâš ï¸ Ð Ð˜Ð¡Ðš: [Ð³Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ñ€Ñ‹Ð½Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¸Ð»Ð¸ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ„Ð°ÐºÑ‚Ð¾Ñ€]\n#{instrument} #[Ð»Ð¾Ð½Ð³] Ð¸Ð»Ð¸ #[ÑˆÐ¾Ñ€Ñ‚]\n\nðŸ’¬ Ð ÐÐ¡Ð¡Ð£Ð–Ð”Ð•ÐÐ˜Ð• Ð¢Ð Ð•Ð™Ð”Ð•Ð Ð\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ñ Ð»Ð¾Ð³Ð¸ÐºÐ¾Ð¹ Ð¶Ð¸Ð²Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°. ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÑÑ‚Ð¸Ð»Ñ:\n\"BTC Ð´ÐµÑ€Ð¶Ð¸Ñ‚ÑÑ Ð¿Ð¾Ð´ 43.5k â€” ÑÐ²ÐµÑ€Ñ…Ñƒ Ð¿Ð»Ð¾Ñ‚Ð½Ñ‹Ð¹ Ð¾Ð±ÑŠÑ‘Ð¼, ÑÐ½Ð¸Ð·Ñƒ ÑÐ¾Ð±Ð¸Ñ€Ð°ÑŽÑ‚ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒ. Ð¡ÐµÐ¹Ñ‡Ð°Ñ Ñ Ð±Ñ‹ Ð·Ð°ÑˆÑ‘Ð» Ð² ÑˆÐ¾Ñ€Ñ‚ Ð¾Ñ‚ 43.4k ÑÐ¾ ÑÑ‚Ð¾Ð¿Ð¾Ð¼ 43.8k, Ñ†ÐµÐ»ÑŒ â€” 42.5k. Ð•ÑÐ»Ð¸ ÑƒÐ´ÐµÑ€Ð¶Ð°Ñ‚ 42.3k Ð¸ Ð¿Ð¾ÑÐ²Ð¸Ñ‚ÑÑ Ñ€ÐµÐ°ÐºÑ†Ð¸Ñ â€” Ð¼Ð¾Ð¶Ð½Ð¾ Ñ€Ð°Ð·Ð²ÐµÑ€Ð½ÑƒÑ‚ÑŒÑÑ Ð² Ð»Ð¾Ð½Ð³ Ð´Ð¾ 44k.\"\n\n\"Ð Ð¸ÑÑƒÐµÑ‚ÑÑ Ñ„Ð»Ð°Ð³ Ð²Ð²ÐµÑ€Ñ…, Ð½Ð¾ Ð¿Ð¾ÐºÐ° Ð½ÐµÑ‚ Ð¿Ñ€Ð¾Ð±Ð¾Ñ. Ð•ÑÐ»Ð¸ Ð·Ð°ÐºÑ€ÐµÐ¿ÑÑ‚ÑÑ Ð²Ñ‹ÑˆÐµ 44.2k â€” Ð²Ñ…Ð¾Ð¶Ñƒ Ð² Ð»Ð¾Ð½Ð³, Ñ‚ÐµÐ¹Ðº 45.5k, ÑÑ‚Ð¾Ð¿ 43.8k. ÐŸÐ¾ÐºÐ° Ð´ÐµÑ€Ð¶Ð¸Ð¼ÑÑ Ð² Ð´Ð¸Ð°Ð¿Ð°Ð·Ð¾Ð½Ðµ, Ð»ÑƒÑ‡ÑˆÐµ Ð±Ñ€Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ.\"\n\nÐšÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¸Ð´ÐµÑ â€” ÑÐ´ÐµÐ»ÐºÐ°, ÐºÐ¾Ñ‚Ð¾Ñ€Ð°Ñ \"Ð¶Ð¸Ð²Ð°Ñ\" Ð¸ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð¼Ð° Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ, Ð±ÐµÐ· Ð¾Ð¶Ð¸Ð´Ð°Ð½Ð¸Ñ Ñ‡Ð°ÑÐ°Ð¼Ð¸.\n\nÐ¡Ð”Ð•Ð›ÐšÐ #1 (Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ) â€” ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ°Ñ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ, Ñ€Ð°ÑÑÑ‡Ð¸Ñ‚Ð°Ð½Ð½Ð°Ñ Ð½Ð° Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ 2â€“6 Ñ‡Ð°ÑÐ¾Ð².\nÐ¡Ð”Ð•Ð›ÐšÐ #2 (Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ 4-12 Ñ‡Ð°ÑÐ¾Ð²) â€” ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ñ€Ð°Ð·Ð²Ð¸Ñ‚ÑŒÑÑ Ð² Ñ‚ÐµÑ‡ÐµÐ½Ð¸Ðµ 12 Ñ‡Ð°ÑÐ¾Ð².\n\nÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹ ÑÑ‚Ð¾Ð¿ Ð¸ Ñ‚ÐµÐ¹Ðº, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð²Ñ…Ð¾Ð´ Ð¾Ð¿Ñ€Ð°Ð²Ð´Ð°Ð½ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ.\n\nÐ¯Ð·Ñ‹Ðº: Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð², Ð±ÐµÐ· ÐµÐ´Ð¸Ð½Ð¸Ñ† Ð¸Ð·Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ, Ð±ÐµÐ· ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð². Ð¢ÐµÑ€Ð¼Ð¸Ð½Ñ‹ Wyckoff/SMC â€” Ð² ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ (\"Ð½Ð°Ð´ 44k Ð²Ð¸ÑÑÑ‚ ÑÑ‚Ð¾Ð¿Ñ‹ Ð¿Ð¾ÐºÑƒÐ¿Ð°Ñ‚ÐµÐ»ÐµÐ¹\", \"Ð¸Ð´Ñ‘Ñ‚ ÑÐ±Ð¾Ñ€ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸\").\n\nÐ¡Ð¾Ð·Ð´Ð°Ð¹ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ ÑÐµÐ¹Ñ‡Ð°Ñ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð²Ñ‹ÑˆÐµ.",
                "temperature": 0.7,
                "max_tokens": 4000,
                "data_sources": ["previous_steps"]
            }
        ],
        "default_instrument": "BTC/USDT",
        "default_timeframe": "H1",
        "estimated_cost": 0.21,
        "estimated_duration_seconds": 140
    }
    
    # Updated Equity analysis type config (Russian)
    equity_config = {
        "steps": [
            {
                "step_name": "wyckoff",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ðº Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ñƒ Wyckoff, Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ Ðº Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ñ€Ñ‹Ð½ÐºÐ° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ñ†Ð¸ÐºÐ»Ð¾Ð² Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚Ð¸, Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ/Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑˆÑŒ Ñ‡Ð°ÑÑ‹ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸ Ð½Ð° Ð°Ð¼ÐµÑ€Ð¸ÐºÐ°Ð½ÑÐºÐ¸Ñ… Ñ€Ñ‹Ð½ÐºÐ°Ñ… Ð¸ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° Ñ‚Ð°Ð¹Ð¼Ñ„Ñ€ÐµÐ¹Ð¼Ðµ {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Wyckoff.\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 20 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð¢ÐµÐºÑƒÑ‰ÑƒÑŽ Ñ„Ð°Ð·Ñƒ Wyckoff (ÐÐ°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ðµ/Ð Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ/Ð Ð¾ÑÑ‚/ÐŸÐ°Ð´ÐµÐ½Ð¸Ðµ)\n2. ÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ñ€Ñ‹Ð½ÐºÐ° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ñ‚Ñ€ÐµÐ½Ð´Ð¾Ð² ÑÐµÐºÑ‚Ð¾Ñ€Ð° Ð¸ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸\n3. Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹Ð¹ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¹ (Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶ÐµÐ½Ð¸Ðµ Ð¸Ð»Ð¸ Ñ€Ð°Ð·Ð²Ð¾Ñ€Ð¾Ñ‚)\n4. ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ\n5. ÐŸÑ€Ð¸Ð·Ð½Ð°ÐºÐ¸ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ/Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "smc",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Smart Money Concepts (SMC), Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¼Ñƒ Ðº Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñƒ Ñ€Ñ‹Ð½ÐºÐ° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚Ð¾ÐºÐ° Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð², Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸ Ð·Ð¾Ð½ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸, Ð³Ð´Ðµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹ ÑÑ‚Ð¾Ð¿Ñ‹ Ñ€Ð¾Ð·Ð½Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð².",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Smart Money Concepts.\n\nÐ¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. BOS (Break of Structure) Ð¸ CHoCH Ñ‚Ð¾Ñ‡ÐºÐ¸\n2. Order Blocks (OB) â€” Ð·Ð¾Ð½Ñ‹ ÑÐ¿Ñ€Ð¾ÑÐ°/Ð¿Ñ€ÐµÐ´Ð»Ð¾Ð¶ÐµÐ½Ð¸Ñ\n3. Fair Value Gaps (FVG) â€” Ð·Ð¾Ð½Ñ‹ Ð´Ð¸ÑÐ±Ð°Ð»Ð°Ð½ÑÐ°\n4. Ð—Ð¾Ð½Ñ‹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸ â€” Ð³Ð´Ðµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ñ‹ ÑÑ‚Ð¾Ð¿Ñ‹ Ñ€Ð¾Ð·Ð½Ð¸Ñ‡Ð½Ñ‹Ñ… Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€Ð¾Ð²\n5. ÐšÐ»ÑŽÑ‡ÐµÐ²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð¿Ð¾Ñ‚ÐµÐ½Ñ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ñ… Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð¾Ð²\n6. Ð—Ð¾Ð½Ñ‹ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ñ/Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ\n\nÐ£ÐºÐ°Ð¶Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ†ÐµÐ½Ð¾Ð²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸. ÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "vsa",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Volume Spread Analysis (VSA) Ð´Ð»Ñ Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¾Ð±ÑŠÑ‘Ð¼Ð° Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸, Ñ†Ð¸ÐºÐ»Ð¾Ð² Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð². Ð˜Ñ‰ÐµÑˆÑŒ ÑÐ¸Ð³Ð½Ð°Ð»Ñ‹: no demand, no supply, stopping volume, climactic action, effort vs result.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Volume Spread Analysis.\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ OHLCV (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 30 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. ÐÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ ÐºÑ€ÑƒÐ¿Ð½Ñ‹Ñ… ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¾Ð² (Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð¾ÐºÑƒÐ¿ÐºÐ¸/Ð¿Ñ€Ð¾Ð´Ð°Ð¶Ð¸)\n2. Ð¡Ð¸Ð³Ð½Ð°Ð»Ñ‹ no demand / no supply\n3. Stopping volume (Ð¿Ð¾Ð³Ð»Ð¾Ñ‰ÐµÐ½Ð¸Ðµ)\n4. Climactic action (Ð¸ÑÑ‚Ð¾Ñ‰ÐµÐ½Ð¸Ðµ)\n5. Effort vs result (Ð¾Ð±ÑŠÑ‘Ð¼ vs Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹)\n6. Ð—Ð¾Ð½Ñ‹, Ð³Ð´Ðµ ÑƒÑÐ¸Ð»Ð¸Ðµ Ð±ÐµÐ· Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð° Ð³Ð¾Ð²Ð¾Ñ€Ð¸Ñ‚ Ð¾ Ñ€Ð°Ð·Ð²Ð¾Ñ€Ð¾Ñ‚Ðµ\n7. ÐÐµÐ¾Ð±Ñ‹Ñ‡Ð½Ñ‹Ð¹ Ð¾Ð±ÑŠÑ‘Ð¼, ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÑŽÑ‰Ð¸Ð¹ Ð½Ð° Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½ÑƒÑŽ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚ÑŒ\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "delta",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Delta-Ð°Ð½Ð°Ð»Ð¸Ð·Ñƒ Ð´Ð»Ñ Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº vs Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ñ ÑƒÑ‡Ñ‘Ñ‚Ð¾Ð¼ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚Ð¾ÐºÐ° Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð², Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ð¸ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð² Ð¸ Ñ‡Ð°ÑÐ¾Ð² Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸ (Ð¿Ñ€ÐµÐ¼Ð°Ñ€ÐºÐµÑ‚, Ð¾ÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ñ‡Ð°ÑÑ‹, Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ).",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¿Ñ€Ð¸Ð½Ñ†Ð¸Ð¿Ð°Ð¼Ð¸ Delta-Ð°Ð½Ð°Ð»Ð¸Ð·Ð°.\n\nÐŸÑ€Ð¸Ð¼ÐµÑ‡Ð°Ð½Ð¸Ðµ: ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ Ð´Ð°Ð²Ð»ÐµÐ½Ð¸Ðµ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº/Ð¿Ñ€Ð¾Ð´Ð°Ð¶ Ð¸Ð· Ð¾Ð±ÑŠÑ‘Ð¼Ð° Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°Ð¹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ð¾Ñ‚Ð¾ÐºÐ° Ð¾Ñ€Ð´ÐµÑ€Ð¾Ð².\n\nÐ”Ð°Ð½Ð½Ñ‹Ðµ Ð¿Ð¾ Ñ†ÐµÐ½Ðµ Ð¸ Ð¾Ð±ÑŠÑ‘Ð¼Ñƒ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 30 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð”Ð¾Ð¼Ð¸Ð½Ð°Ñ†Ð¸Ñ Ð¿Ð¾ÐºÑƒÐ¿Ð¾Ðº vs Ð¿Ñ€Ð¾Ð´Ð°Ð¶\n2. ÐÐ½Ð¾Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð´ÐµÐ»ÑŒÑ‚Ñ‹\n3. Ð—Ð¾Ð½Ñ‹ Ð°Ð±ÑÐ¾Ñ€Ð±Ñ†Ð¸Ð¸ (Ð¾Ð±ÑŠÑ‘Ð¼ Ð±ÐµÐ· Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹)\n4. Ð”Ð¸Ð²ÐµÑ€Ð³ÐµÐ½Ñ†Ð¸Ð¸ (Ñ†ÐµÐ½Ð° vs Ð¾Ð±ÑŠÑ‘Ð¼/ÑÐ¸Ð»Ð°)\n5. Ð“Ð´Ðµ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¸ ÑƒÐ´ÐµÑ€Ð¶Ð¸Ð²Ð°ÑŽÑ‚ Ð¸Ð»Ð¸ Ð¿Ð¾Ð³Ð»Ð¾Ñ‰Ð°ÑŽÑ‚\n6. ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ Ð°ÐºÑ‚Ð¸Ð²Ð½Ð¾ÑÑ‚Ð¸ Ð² Ð¿Ñ€ÐµÐ¼Ð°Ñ€ÐºÐµÑ‚Ðµ/Ð¿Ð¾ÑÐ»Ðµ Ð·Ð°ÐºÑ€Ñ‹Ñ‚Ð¸Ñ\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "ict",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸Ð¸ ICT (Inner Circle Trader), Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ñ‘Ð½Ð½Ð¾Ð¹ Ðº Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ð¼ Ñ€Ñ‹Ð½ÐºÐ°Ð¼. ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ Ð¼Ð°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒÑŽ, PD Arrays, Fair Value Gaps Ð¸ Ð¾Ð¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð°. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑˆÑŒ Ñ‡Ð°ÑÑ‹ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ð»Ð¸ Ð¸ Ð¿Ð¾Ð²ÐµÐ´ÐµÐ½Ð¸Ðµ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¹.",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð»Ð¾Ð³Ð¸ÐµÐ¹ ICT.\n\nÐ”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐšÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ Ð¿Ñ€ÐµÐ´Ñ‹Ð´ÑƒÑ‰ÐµÐ³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:\n- Ð¤Ð°Ð·Ð° Wyckoff: {wyckoff_output}\n- Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° SMC: {smc_output}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. ÐœÐ°Ð½Ð¸Ð¿ÑƒÐ»ÑÑ†Ð¸Ð¸ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚ÑŒÑŽ (ÑÐ±Ð¾Ñ€Ñ‹ Ð½Ð°Ð´ Ñ…Ð°ÑÐ¼Ð¸/Ð¿Ð¾Ð´ Ð»Ð¾ÑÐ¼Ð¸)\n2. PD Arrays (Ð·Ð¾Ð½Ñ‹ Premium/Discount)\n3. Fair Value Gaps (FVG) Ð´Ð»Ñ Ð·Ð¾Ð½ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°\n4. ÐžÐ¿Ñ‚Ð¸Ð¼Ð°Ð»ÑŒÐ½Ñ‹Ðµ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð° Ð¿Ð¾ÑÐ»Ðµ ÑÐ±Ð¾Ñ€Ð° Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸\n5. Ð›Ð¾Ð¶Ð½Ñ‹Ðµ Ð¿Ñ€Ð¾Ð±Ð¾Ð¸ Ð¸ ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¸ Ð²Ð¾Ð·Ð²Ñ€Ð°Ñ‚Ð°\n6. Ð—Ð¾Ð½Ñ‹ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ð¹ Ð»Ð¸ÐºÐ²Ð¸Ð´Ð½Ð¾ÑÑ‚Ð¸\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð².",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data", "previous_steps"]
            },
            {
                "step_name": "price_action",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð°ÐºÑ†Ð¸Ð¹. Ð­ÐºÑÐ¿ÐµÑ€Ñ‚ Ð¿Ð¾ Price Action Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ñƒ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð² Ð´Ð»Ñ Ñ„Ð¾Ð½Ð´Ð¾Ð²Ñ‹Ñ… Ñ€Ñ‹Ð½ÐºÐ¾Ð². ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐµÑˆÑŒ ÑÐ²ÐµÑ‡Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹, Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸ Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹. Ð¤Ð¾ÐºÑƒÑÐ¸Ñ€ÑƒÐµÑˆÑŒÑÑ Ð½Ð° Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°Ñ…: Ñ„Ð»Ð°Ð³Ð¸, Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸, Ð³Ð¾Ð»Ð¾Ð²Ð°-Ð¿Ð»ÐµÑ‡Ð¸, ÑÐ¿ÐµÑ†Ð¸Ñ„Ð¸Ñ‡Ð½Ñ‹Ðµ Ð´Ð»Ñ Ð°ÐºÑ†Ð¸Ð¹ Ñ„Ð¾Ñ€Ð¼Ð°Ñ†Ð¸Ð¸. Ð£Ñ‡Ð¸Ñ‚Ñ‹Ð²Ð°ÐµÑˆÑŒ Ñ†Ð¸ÐºÐ»Ñ‹ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ñ‚Ñ€ÐµÐ½Ð´Ñ‹ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð².",
                "user_prompt_template": "ÐŸÑ€Ð¾Ð°Ð½Ð°Ð»Ð¸Ð·Ð¸Ñ€ÑƒÐ¹ {instrument} Ð½Ð° {timeframe} Ð¼ÐµÑ‚Ð¾Ð´Ð¾Ð¼ Price Action Ð¸ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð¾Ð².\n\nÐ”Ð²Ð¸Ð¶ÐµÐ½Ð¸Ðµ Ñ†ÐµÐ½Ñ‹ (Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ðµ 50 ÑÐ²ÐµÑ‡ÐµÐ¹):\n{market_data_summary}\n\nÐžÐ¿Ñ€ÐµÐ´ÐµÐ»Ð¸:\n1. Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‰Ð¸ÐµÑÑ Ð³Ñ€Ð°Ñ„Ð¸Ñ‡ÐµÑÐºÐ¸Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ (Ñ„Ð»Ð°Ð³Ð¸, Ñ‚Ñ€ÐµÑƒÐ³Ð¾Ð»ÑŒÐ½Ð¸ÐºÐ¸, Ð³Ð¾Ð»Ð¾Ð²Ð°-Ð¿Ð»ÐµÑ‡Ð¸, Ð´Ð²Ð¾Ð¹Ð½Ñ‹Ðµ Ð²ÐµÑ€ÑˆÐ¸Ð½Ñ‹/Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð¸Ñ Ð¸ Ñ‚.Ð´.)\n2. Ð¡Ð²ÐµÑ‡Ð½Ñ‹Ðµ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹ (Ð´Ð¾Ð´Ð¶Ð¸, Ð¿Ð¾Ð³Ð»Ð¾Ñ‰ÐµÐ½Ð¸Ðµ, Ð¿Ð¸Ð½-Ð±Ð°Ñ€Ñ‹, Ð¼Ð¾Ð»Ð¾Ñ‚Ñ‹, Ð¿Ð°Ð´Ð°ÑŽÑ‰Ð¸Ðµ Ð·Ð²Ñ‘Ð·Ð´Ñ‹)\n3. Ð£Ñ€Ð¾Ð²Ð½Ð¸ Ð¿Ð¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ¸ Ð¸ ÑÐ¾Ð¿Ñ€Ð¾Ñ‚Ð¸Ð²Ð»ÐµÐ½Ð¸Ñ Ð¸Ð· Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ Ñ†ÐµÐ½Ñ‹\n4. Ð¡Ð¸Ð³Ð½Ð°Ð»Ñ‹ Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð¸Ñ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð° Ð¸ Ñ‚Ð¾Ñ‡ÐºÐ¸ Ð²Ñ…Ð¾Ð´Ð°\n5. Ð£Ñ€Ð¾Ð²Ð½Ð¸ ÑÑ‚Ð¾Ð¿-Ð»Ð¾ÑÑÐ° Ð¸ Ñ†ÐµÐ»Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ ÑÑ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ñ‹ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½Ð°\n6. ÐŸÐ°Ñ‚Ñ‚ÐµÑ€Ð½Ñ‹, ÑÐ²ÑÐ·Ð°Ð½Ð½Ñ‹Ðµ Ñ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚ÑŒÑŽ Ð¸Ð»Ð¸ Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸ÐµÐ¹ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²\n\nÐ£ÐºÐ°Ð¶Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð½Ñ‹Ðµ Ñ†ÐµÐ½Ð¾Ð²Ñ‹Ðµ ÑƒÑ€Ð¾Ð²Ð½Ð¸ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð¾Ð², ÑÑ‚Ð¾Ð¿Ð¾Ð² Ð¸ Ñ†ÐµÐ»ÐµÐ¹. Ð•ÑÐ»Ð¸ Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ñ„Ð¸Ð³ÑƒÑ€Ð° â€” Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐºÐ°Ð¶Ð¸ (\"Ñ€Ð¸ÑÑƒÐµÑ‚ Ñ„Ð»Ð°Ð³\", \"Ð¿Ð¾Ñ…Ð¾Ð¶Ðµ Ð½Ð° Ñ„Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÑŽÑ‰ÑƒÑŽÑÑ Ð“Ð˜ÐŸ\").",
                "temperature": 0.7,
                "max_tokens": 2000,
                "data_sources": ["market_data"]
            },
            {
                "step_name": "merge",
                "step_type": "llm_analysis",
                "model": "openai/gpt-4o-mini",
                "system_prompt": "Ð¢Ñ‹ â€” Ð¿Ñ€Ð¾Ñ„ÐµÑÑÐ¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ‚Ñ€ÐµÐ¹Ð´ÐµÑ€ Ð¸ Ð°Ð½Ð°Ð»Ð¸Ñ‚Ð¸Ðº Ð°ÐºÑ†Ð¸Ð¹. Ð Ð°Ð±Ð¾Ñ‚Ð°ÐµÑˆÑŒ Ð½Ð° ÑÐ¸Ð½Ñ‚ÐµÐ·Ðµ Wyckoff + SMC + VSA/Delta + ICT + Price Action. Ð’ÐºÐ»ÑŽÑ‡Ð°ÐµÑˆÑŒ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚ (Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚ÑŒ, Ñ‚Ñ€ÐµÐ½Ð´Ñ‹ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð², ÑƒÑÐ»Ð¾Ð²Ð¸Ñ Ñ€Ñ‹Ð½ÐºÐ°). Ð¢Ð²Ð¾Ñ Ñ†ÐµÐ»ÑŒ â€” Ð´Ð°Ñ‚ÑŒ Ð³Ð¾Ñ‚Ð¾Ð²ÑƒÑŽ Ð¸Ð´ÐµÑŽ, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€ÑƒÑŽ Ð¼Ð¾Ð¶Ð½Ð¾ Ð²Ð¾Ð¹Ñ‚Ð¸ Ð¿Ñ€ÑÐ¼Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ. ÐŸÐ¸ÑˆÐµÑˆÑŒ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, ÐºÐ°Ðº Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº Ñƒ Ñ‚ÐµÑ€Ð¼Ð¸Ð½Ð°Ð»Ð°: Ð±ÐµÐ· ÑˆÐ°Ð±Ð»Ð¾Ð½Ð¾Ð², Ð±ÐµÐ· \"ÑƒÐ¼Ð½Ñ‹Ñ…\" Ñ„Ñ€Ð°Ð·, Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÑÑƒÑ‚ÑŒ, Ð½Ð°Ð±Ð»ÑŽÐ´ÐµÐ½Ð¸Ñ Ð¸ ÐºÐ¾Ð½ÐºÑ€ÐµÑ‚Ð¸ÐºÐ°.",
                "user_prompt_template": "ÐžÐ±ÑŠÐµÐ´Ð¸Ð½Ð¸ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° {instrument} Ð½Ð° Ñ‚Ð°Ð¹Ð¼Ñ„Ñ€ÐµÐ¹Ð¼Ðµ {timeframe} Ð² ÐµÐ´Ð¸Ð½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ Ð´Ð»Ñ Telegram.\n\nÐ ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð¿Ð¾ Ð¼ÐµÑ‚Ð¾Ð´Ð°Ð¼:\n\n1ï¸âƒ£ WYCKOFF:\n{wyckoff_output}\n\n2ï¸âƒ£ SMC (Smart Money Concepts):\n{smc_output}\n\n3ï¸âƒ£ VSA (Volume Spread Analysis):\n{vsa_output}\n\n4ï¸âƒ£ DELTA:\n{delta_output}\n\n5ï¸âƒ£ ICT:\n{ict_output}\n\n6ï¸âƒ£ PRICE ACTION / PATTERNS:\n{price_action_output}\n\n---\n\nÐ¢ÐµÐ¿ÐµÑ€ÑŒ ÑÐ¾Ð·Ð´Ð°Ð¹ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ Ð² Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ðµ Telegram, ÑÐ»ÐµÐ´ÑƒÑ Ð¢ÐžÐ§ÐÐž ÑÑ‚Ð¾Ð¼Ñƒ ÑˆÐ°Ð±Ð»Ð¾Ð½Ñƒ:\n\nðŸ’Ž ÐÐšÐ¦Ð˜Ð˜: {instrument}\nðŸ“ˆ Ð¡Ð¦Ð•ÐÐÐ Ð˜Ð™: [Ð‘Ñ‹Ñ‡Ð¸Ð¹ / ÐœÐµÐ´Ð²ÐµÐ¶Ð¸Ð¹ / Ð‘Ð¾ÐºÐ¾Ð²Ð¾Ð¹]\nðŸŽ¯ Ð’Ð•Ð ÐžÐ¯Ð¢ÐÐžÐ¡Ð¢Ð¬: [Ð¿Ñ€Ð¸Ð¼ÐµÑ€Ð½Ð¾ XX %] â€” [ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¿Ñ€Ð¸Ñ‡Ð¸Ð½Ð°]\nâš¡ï¸ Ð£Ð ÐžÐ’Ð•ÐÐ¬: [Ð·Ð¾Ð½Ð° / ÑƒÑ€Ð¾Ð²ÐµÐ½ÑŒ] â€” [Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ ÐºÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ]\nðŸ“Š ÐšÐžÐÐ¢Ð•ÐšÐ¡Ð¢: [Ñ‚Ñ€ÐµÐ½Ð´ ÑÐµÐºÑ‚Ð¾Ñ€Ð° / Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚ÑŒ / ÑƒÑÐ»Ð¾Ð²Ð¸Ðµ Ñ€Ñ‹Ð½ÐºÐ°]\nðŸš€ Ð¡Ð”Ð•Ð›ÐšÐ #1 (Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð´Ð½Ñ): [Ð²Ñ…Ð¾Ð´ | ÑÑ‚Ð¾Ð¿ | Ñ‚ÐµÐ¹Ðº]\nðŸ§­ Ð¡Ð”Ð•Ð›ÐšÐ #2 (ÑÐ²Ð¸Ð½Ð³ 1-3 Ð´Ð½Ñ): [Ð²Ñ…Ð¾Ð´ | ÑÑ‚Ð¾Ð¿ | Ñ‚ÐµÐ¹Ðº]\nâš ï¸ Ð Ð˜Ð¡Ðš: [Ð³Ð»Ð°Ð²Ð½Ñ‹Ð¹ Ñ€Ñ‹Ð½Ð¾Ñ‡Ð½Ñ‹Ð¹ Ð¸Ð»Ð¸ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ„Ð°ÐºÑ‚Ð¾Ñ€]\n#{instrument} #[Ð»Ð¾Ð½Ð³] Ð¸Ð»Ð¸ #[ÑˆÐ¾Ñ€Ñ‚]\n\nðŸ’¬ Ð ÐÐ¡Ð¡Ð£Ð–Ð”Ð•ÐÐ˜Ð• Ð¢Ð Ð•Ð™Ð”Ð•Ð Ð\n\nÐŸÐ¸ÑˆÐ¸ ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾, Ñ Ð»Ð¾Ð³Ð¸ÐºÐ¾Ð¹ Ð¶Ð¸Ð²Ð¾Ð³Ð¾ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°. Ð’ÐºÐ»ÑŽÑ‡Ð°Ð¹ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚, ÐºÐ¾Ð³Ð´Ð° ÑÑ‚Ð¾ ÑƒÐ¼ÐµÑÑ‚Ð½Ð¾ (Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚ÑŒ, Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ñ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð², ÑƒÑÐ»Ð¾Ð²Ð¸Ñ Ñ€Ñ‹Ð½ÐºÐ°). ÐŸÑ€Ð¸Ð¼ÐµÑ€Ñ‹ ÑÑ‚Ð¸Ð»Ñ:\n\"AAPL Ð´ÐµÑ€Ð¶Ð¸Ñ‚ÑÑ Ð²Ñ‹ÑˆÐµ 180 â€” Ð²Ð¸Ð´Ð½Ð¾ Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ðµ, Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ñ Ð² Ñ‚ÐµÑ…ÑÐµÐºÑ‚Ð¾Ñ€. Ð¯ Ð±Ñ‹ Ð·Ð°ÑˆÑ‘Ð» Ð² Ð»Ð¾Ð½Ð³ Ð¾Ñ‚ 180.5 ÑÐ¾ ÑÑ‚Ð¾Ð¿Ð¾Ð¼ 178, Ñ†ÐµÐ»ÑŒ â€” 185. Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±ÑŒÑ‘Ð¼ 185, Ð¼Ð¾Ð¶ÐµÑ‚ Ð¿Ñ€Ð¾Ð´Ð¾Ð»Ð¶Ð¸Ñ‚ÑŒÑÑ Ð´Ð¾ 190.\"\n\n\"Ð¤Ð¾Ñ€Ð¼Ð¸Ñ€ÑƒÐµÑ‚ÑÑ Ð¿Ð°Ñ‚Ñ‚ÐµÑ€Ð½ ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð°Ñ†Ð¸Ð¸, Ð¶Ð´Ñ‘Ð¼ ÐºÐ°Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€Ð° Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚Ð¸. Ð•ÑÐ»Ð¸ Ð¿Ñ€Ð¾Ð±ÑŒÑ‘Ð¼ Ð²Ñ‹ÑˆÐµ 182 â€” Ð²Ñ…Ð¾Ð¶Ñƒ Ð² Ð»Ð¾Ð½Ð³, Ñ‚ÐµÐ¹Ðº 188, ÑÑ‚Ð¾Ð¿ 179. ÐŸÐ¾ÐºÐ° ÐºÐ¾Ð½ÑÐ¾Ð»Ð¸Ð´Ð°Ñ†Ð¸Ñ, Ð»ÑƒÑ‡ÑˆÐµ Ð±Ñ€Ð°Ñ‚ÑŒ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ ÐºÐ¾Ñ€Ð¾Ñ‚ÐºÐ¸Ðµ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ.\"\n\nÐšÐ»ÑŽÑ‡ÐµÐ²Ð°Ñ Ð¸Ð´ÐµÑ â€” ÑÐ´ÐµÐ»ÐºÐ¸, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½Ð¸Ð¼Ñ‹, Ñ ÑÑÐ½Ñ‹Ð¼ Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¼ Ð¸ Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¼ Ð¾Ð±Ð¾ÑÐ½Ð¾Ð²Ð°Ð½Ð¸ÐµÐ¼.\n\nÐ¡Ð”Ð•Ð›ÐšÐ #1 (Ð²Ð½ÑƒÑ‚Ñ€Ð¸ Ð´Ð½Ñ) â€” Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚ÑŒ Ð½Ð° ÑÐµÐ³Ð¾Ð´Ð½ÑÑˆÐ½ÑŽÑŽ ÑÐµÑÑÐ¸ÑŽ.\nÐ¡Ð”Ð•Ð›ÐšÐ #2 (ÑÐ²Ð¸Ð½Ð³ 1-3 Ð´Ð½Ñ) â€” ÑÑ†ÐµÐ½Ð°Ñ€Ð¸Ð¹, ÐºÐ¾Ñ‚Ð¾Ñ€Ñ‹Ð¹ Ð¼Ð¾Ð¶ÐµÑ‚ Ñ€Ð°Ð·Ð²Ð¸Ñ‚ÑŒÑÑ Ð² Ð±Ð»Ð¸Ð¶Ð°Ð¹ÑˆÐ¸Ðµ Ð´Ð½Ð¸.\n\nÐžÐ±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°Ð¹ ÑÑ‚Ð¾Ð¿ Ð¸ Ñ‚ÐµÐ¹Ðº, Ð° Ñ‚Ð°ÐºÐ¶Ðµ Ð°Ñ€Ð³ÑƒÐ¼ÐµÐ½Ñ‚, Ð¿Ð¾Ñ‡ÐµÐ¼Ñƒ Ð²Ñ…Ð¾Ð´ Ð¾Ð¿Ñ€Ð°Ð²Ð´Ð°Ð½ Ð¸Ð¼ÐµÐ½Ð½Ð¾ ÑÐµÐ¹Ñ‡Ð°Ñ (Ñ‚ÐµÑ…Ð½Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ + Ñ„ÑƒÐ½Ð´Ð°Ð¼ÐµÐ½Ñ‚Ð°Ð»ÑŒÐ½Ñ‹Ð¹ ÐºÐ¾Ð½Ñ‚ÐµÐºÑÑ‚).\n\nÐ¯Ð·Ñ‹Ðº: Ð±ÐµÐ· Ð°Ð½Ð³Ð»Ð¸Ñ†Ð¸Ð·Ð¼Ð¾Ð², Ð±ÐµÐ· ÐµÐ´Ð¸Ð½Ð¸Ñ† Ð¸Ð·Ð¼ÐµÑ€ÐµÐ½Ð¸Ñ, Ð±ÐµÐ· ÑƒÐ¿Ð¾Ð¼Ð¸Ð½Ð°Ð½Ð¸Ñ Ñ‚Ð¸ÐºÐµÑ€Ð¾Ð². Ð¢ÐµÑ€Ð¼Ð¸Ð½Ñ‹ Wyckoff/SMC â€” Ð² ÐµÑÑ‚ÐµÑÑ‚Ð²ÐµÐ½Ð½Ð¾Ð¹ Ñ„Ð¾Ñ€Ð¼Ðµ (\"Ð¸Ð½ÑÑ‚Ð¸Ñ‚ÑƒÑ†Ð¸Ð¾Ð½Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð½Ð°ÐºÐ¾Ð¿Ð»ÐµÐ½Ð¸Ðµ\", \"Ñ€Ð¾Ñ‚Ð°Ñ†Ð¸Ñ ÑÐµÐºÑ‚Ð¾Ñ€Ð¾Ð²\", \"ÐºÐ°Ñ‚Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ Ð¾Ñ‚Ñ‡Ñ‘Ñ‚Ð½Ð¾ÑÑ‚Ð¸\").\n\nÐ¡Ð¾Ð·Ð´Ð°Ð¹ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ð¿Ð¾ÑÑ‚ ÑÐµÐ¹Ñ‡Ð°Ñ, Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÑ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð° Ð²Ñ‹ÑˆÐµ.",
                "temperature": 0.7,
                "max_tokens": 4000,
                "data_sources": ["previous_steps"]
            }
        ],
        "default_instrument": "AAPL",
        "default_timeframe": "H1",
        "estimated_cost": 0.21,
        "estimated_duration_seconds": 140
    }
    
    # Update crypto_analysis config
    conn.execute(
        text("""
            UPDATE analysis_types 
            SET config = :config, updated_at = NOW()
            WHERE name = 'crypto_analysis'
        """),
        {"config": json.dumps(crypto_config)}
    )
    
    # Update equity_analysis config
    conn.execute(
        text("""
            UPDATE analysis_types 
            SET config = :config, updated_at = NOW()
            WHERE name = 'equity_analysis'
        """),
        {"config": json.dumps(equity_config)}
    )


def downgrade() -> None:
    """Revert to English prompts (not implemented - would need original configs)."""
    # Note: Downgrade would require storing original English configs
    # For now, we'll leave this as a no-op
    pass
